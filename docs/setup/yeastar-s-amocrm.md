---
icon: tools
---
# Yeastar S-серия и amoCRM
> [!CAUTION] ВАЖНО!
> Внимательно прочитайте и выполните каждый пункт руководства, чтобы правильно настроить интеграцию Callbee.

> [!NOTE] Необходимые требования
> *   IP-АТС **серии S** (S20, S50, S100, S300).
> *   **Статический** IP-адрес
> *   Личный кабинет **Callbee**.
> *   Активная лицензия **amoCRM**.
> *   Доступ к TCP портам **5038**, **8088** либо (**21** для **S20**) IP-АТС Yeastar с разрешенных адресов сервиса.
> *   Настроенное **хранилище S3** (если применимо для вашей модели АТС и задач).
---
## Видеоинструкция
https://www.youtube.com/watch?v=dQw4w9WgXcQ

---
## 1. Установка виджета Callbee | FreePBX и Yeastar в amoCRM
*  Находим Виджет **Callbee | FreePBX и Yeastar** в **amoМаркет**.

    ![Находим виджет Callbee | FreePBX и Yeastar в amoМаркет](img/callbee-amo-install.png)
*  Устанавливаем Виджет, подтвердив согласие с **Политикой обработки персональных данных** и нажав кнопку **"Внешняя оплата"**.

    ![Установка виджета Callbee | FreePBX и Yeastar](img/callbee-amo-install-widget.png)
*  После успешной установки виджета нажмаем кнопку **"Сохранить"**.

    ![Сохранение виджета Callbee | FreePBX и Yeastar](img/callbee-amo-install-save.png)

!!!success Поздравляем!
Вы установили Виджет Callbee | FreePBX и Yeastar.
!!!

---
## 2. Настраиваем подключение сервиса к IP-АТС
> [!CAUTION] ВАЖНО!
> Успех интеграции напрямую зависит от правильной настройки соединения с сервисом AMI и IP-АТС Yeastar через API или FTP. Помните, что функциональность API отсутствует в моделях Yeastar S-серии, таких как S20.

### 2.1 Настройка сетевых служб - AMI

  #### Шаги для активации и настройки AMI IP-ATC:

-  Откройте **админ-панель IP-АТС** и перейдите в раздел **Настройки** &gt; **Система** &gt; **Безопасность**.
  Во вкладке **Сетевые службы** найдите и активируйте пункт **Включить AMI**.
-  Измените стандартные **Имя пользователя и Пароль для AMI**. Эти учетные данные потребуются для указания в **личном кабинете Callbee**.
-  В появившемся поле **"Разрешённые IP/Маска"** пропишите IP-адреса из **списка адресов сервиса**.
    ![Настраиваем подключение к AMI:](img/amo-ami-s.png)
-  **Измените протокол с HTTPS на HTTP** (только если на АТС не установлен валидный SSL-сертификат).
    ![Измените протокол с HTTPS на HTTP:](img/amo-ami-http-s.png)
-  **Сохраните** внесенные изменения, нажав кнопку **"Сохранить"**.
### 2.2 Настройки Yeastar API

Шаги для активации и настройки **API Yeastar**:

-  Откройте **админ-панель IP-АТС** и перейдите в раздел **Настройки** &gt; **АТС** &gt; **API**.
-  Во вкладке **API** найдите и активируйте опцию **Активировать API**.
-  Задайте **Имя пользователя API и Пароль API**. Эти учетные данные понадобятся вам для настройки подключения в **личном кабинете Callbee**.
-  Сохраните внесенные изменения, нажав кнопку **Сохранить**.
    ![Настройки АТС - API:](img/amo-api-s.png)
### 2.3 Настройка хранилища данных (FTP) **Только Yeastar S20**

  #### Шаги для активации **FTP**:

-  Перейдите в раздел **Настройки** &gt; **Система** &gt; **Хранилища данных**.
-  Во вкладке **Файловое хранилище** найдите и активируйте опцию **Активировать FTP доступ**.
-  Сохраните внесенные изменения, нажав кнопку **"Сохранить"**.
    ![Активация FTP:](img/amo-ftp-activate-s.png)

> [!CAUTION] ВАЖНО!
> Для подключения к **FTP** используются те же данные, что и для **SSH**. Имя пользователя – support, а пароль необходимо будет запросить после активации **SSH-соединения**.


  #### Получение пароля **FTP**:

-  Откройте **админ-панель IP-АТС** и перейдите в раздел **Настройки** &gt; **Система** &gt; **Безопасность**.
- Во вкладке **Сетевые службы** найдите и **активируйте пункт "Включить SSH"**. Эти учетные данные потребуются при конфигурации в **личном кабинете Callbee** для настройки **FTP**.
    ![Пароль FTP:](img/amo-ftp-pass-s.png)

---
## 3. Сетевые настройки
Для того, чтобы интеграция могла подключиться к вашей АТС, у вас обязательно должен быть **статический IP-адрес** и проброшены через NAT к АТС следующие порты:

-   **5038 TCP** – для доступа к AMI Yeastar.
-   **21 TCP** – для доступа к FTP Yeastar (для Yeastar S20).
-   **8088 (порт к WEB интерфейсу по умолчанию) HTTP/HTTPS** – для доступа к API Yeastar.
---
## 4. Создание и подключение сервиса в личном кабинете my.callbee.io
  #### Шаги для настройки сервиса в личном кабинете:

-  Войдите в **личный кабинет my.callbee.io**.
-  Запустите **установщик**, который поможет создать **сервис**.
    ![Запустите установщик, который поможет создать сервис.](img/create-callbee.png)
-  **В разделе выбора CRM системы**:
    ![В разделе выбора CRM системы:](img/amo-mycallbee-step1-s.png)
    *   Выберите **"amoCRM"** из списка.
    *   Введите адрес вашей amoCRM в поле **"AMOCRM DOMAIN"**.
    *   Выберите **"IP-ATC Yeastar"**.
    *   Укажите серию вашей IP-АТС Yeastar (например, **"S"**).
    *   Нажмите **"Continue"** для перехода к следующему шагу.
-  **Настраиваем подключение к AMI**:
    ![Настраиваем подключение к AMI:](img/amo-mycallbee-step2-s.png)
    *   Введите **адрес и порт** для подключения к AMI (обычно `5038`).
    *   Укажите **AMI USERNAME** и **AMI SECRET**, которые вы задали в пункте 2.1.
    *   Нажмите **"Continue"** для перехода к следующему шагу.
-  **Настраиваем подключение к API**:
    ![Настраиваем подключение к API:](img/amo-mycallbee-step3-api-s.png)
    *   **Укажите внешний IP-адрес вашей IP-АТС в поле "API HOST"**. Этот адрес должен быть доступен для адресов сервиса Callbee. (обычно `8088`)
    *   Укажите **API USERNAME** и **API SECRET**, которые вы задали в пункте 2.2.
    *   Нажмите **"Continue"** для перехода дальше.
-  **Для S20: Настраиваем подключения к FTP:**:
  ![Для S20: Настраиваем подключения к FTP:](img/amo-mycallbee-step3-ftp-s.png)
    *   Введите внешний IP-адрес вашей IP-АТС в поле **FTP HOST**  и порт (обычно `21`). 
    *   Укажите **FTP USERNAME** и **FTP SECRET**, которые вы задали в пункте 2.3 (при наличии).

-  **Настройка правил создания сущностей:**
  ![Настройка правил создания сущностей:](img/amo-mycallbee-step4-s.png)
    * Настройте правила для автоматического создания **сделок** или **контактов** в amoCRM. Здесь вы можете определить, при каких условиях будет создаваться новая сущность (например, при первом звонке от неизвестного номера).
    *   Сохраните внесенные изменения, нажав кнопку **"Continue"**.

-  **Настройка расположения и часового пояса сервиса:**
> [!CAUTION] ВАЖНО!
> Эта настройка критически важна для корректной работы функции умной маршрутизации звонков.


*  Выберите **регион расположения сервиса**, наиболее близкий к вашему местоположению или местоположению ваших сотрудников. Доступны следующие опции: **Беларусь, Россия, Казахстан, Нидерланды**.
* Укажите **часовой пояс**, в котором работают ваши сотрудники. 
*   Сохраните внесенные изменения, нажав кнопку **"Continue"**.

![Настройка расположения и часового пояса сервиса:]()

!!!success Поздравляем!
Вы создали и запустили сервис  Callbee.
!!!


